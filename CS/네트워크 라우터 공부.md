---

mindmap-plugin: basic

---

# 네트워크 라우터

## 라우터 저장장치 및 CPU
- Boot ROM
	- 부팅될 때 하드웨어를 진단
	- Flash 메모리에서 메모리로 운영체제(cisco ios) 소프트웨어를 불러들임
- Flash
	- 운영체제 이미지를 영구저장하는 비휘발성 메모리
	- 저장된 데이터를 수정 할 수 있어 운영체제 소프트웨어를 업그레이드 할 수 있음
- DRAM(Dynamic RAM)
	- 운영체제가 실행되거나 라우팅 테이블, 현재 사용하는 라우터 환경설정이 저장될 때 사용됨.
- NVRAM(Non-volatile RAM)
	- 라우터 구성 정보를 영구 저장하는 저장장치

## Network Interface Module(네트워크 인터페이스 모듈)
- 시리얼포트
	- V.35케이블이나 RS-232C케이블을 이용하여 DCE장비에 접속
- 이더넷 or Fast Ethernet 포트
	- 라우터에 연결된 랜으로부터 패킷을 받아 외부 네트워크로 전송할때 사용
- 콘솔 포트 & 보조 포트
	- 라우터 초기 설정을 위해 사용
	- 라우터 복구할 때 사용

## 라우터 패스워드 설정
- Enable 패스워드 설정
	- enable secret | password [사용할 비밀번호]
		- Enable secret
			- 패스워드가 암호화 됨 (sh run 하면 암호 암호화 됨)
		- Enable password
			- 패스워드가 암호화 되지 않음
- 콘솔 패스워드 설정
	- conf t
	- line console 0
	- login
	- password [사용할 비밀번호]
	- Ctrl z로 뒤로가기
	- logout 명령어 치고 연결 다시 시도하면 패드워드를 물어봄
	- 패스워드 해제
		- line con 0
		- no login
		- exit
		- logout 하고 다시 연결하면 패스워드 안뜸
- 보조 패스워드 설정
	- line aux 0
	- login
	- password [사용할 비밀번호]
- 텔넷 패스워드 설정
	- line vty 0 ?
	- line vty 0 15
	- login
	- password [사용할 비밀번호]
- 패스워드 암호화 설정
	- (콘피그 모드에서)service password-encryption

## 인터페이스 동작 상태보기
- Link Status:Down, Line Protocol: Down
	- 물리 계층 문제 = 케이블 문제
- Link Status: UP, Line Protocol: Down
	- 데이터 링크 계층의 문제
		- encapsulations 사용이나 clock rate 명령어 사용으로 해결
- Link Status: UP, Line Protocol: UP
	- 통신 가능한 상태
- 명령어
	- show ip interface brief
	- show controllers serial 0/0

## 라우팅
- Static
	- 장점
		- 오버헤드가 낮음
			- 라우터가 계산을 할 필요가 없음
		- 대역폭의 이용률이 낮음
		- 안전함
			- 자신의 정보를 믿을 수 없는 라우터에 보내지 않음
		- 예측 가능
			- 관리자가 패킷이 어느 경로로 갈지 알 수 있음
	- 단점
		- 유지보수가 어려움
		- 적응력이낮음
	- 개념
		- 사람이 경로를 다 정해줌
		- 신뢰성 높음
		- 내것은 보내지 않고 상대것은 받을수 있게 세팅할수 있음
	- 라우팅 경로 추가 방법
		- Next Hop Address 입력
			- ip route [도착지 네트워크 주소] [서브넷마스크] [Next hop address]
		- Exit 인터페이스 입력
			- ip route [도착지 네트워크 주소] [서브넷마스크] [나가는 방향 인터페이스]
- Dynamic
	- 장점
		- 적응력이 높음
			- 링크가 다운 됐거나, 경로를 새로 발견할 경우 다른 라우터에 알려줌
		- 유지보수가 쉬움
	- 단점
		- 프로세서 오버헤드가 높음
		- 대역폭의 이용률이 높음
	- 개념
		- 라우팅 프로토콜을 이용하여 네트워크 토폴로지나 트래픽의 변화에 따라 동적으로 경로 계산
	- 종류
		- RIP(Routing information Protocol)
			- rip 타이머
				- Route Update Timer
					- 30초의 간격으로 업데이트를 한다
				- Route Invalid Timer
					- 자신이 가지고 있는 네트워크 경로 업데이트 정보를 받으면 리셋된다
					- 만일 한 경로의 업데이트 정보를 180초 안에 받지 못하면 해당 경로를 invalid(유효하지 않음)으로 판단하고 주변 라우터에 알린다
				- Route Flush Timer
					- invalid timer가 180초에 도달하면 60초 후에 라우팅 테이블에서 업데이트 정보가 도달하지 않는 경로를 삭제한다.
				- Holddown Timer
					- Distance vetor 라우팅 프로토콜/라우팅 루프/해결방법/Holddown timer 참고
			- rip 전파방지
				- 외부네트워크에 자신의 라우터 정보를 내보내지 않고 외부 라우터 정보는 받고 싶을때 사용되는 명령어
					- router rip
					- passive-interface [시리얼 넘버]
		- IGRP(lnterior Gateway Routing Protocol)
		- EIGRP(Enhanced interior Gateway Routing Protocol)
		- OSPF(Open Shortest Path First)
		- BGP(Border Gateway Protocol)
- Default
	- ip route 0.0.0.0 0.0.0.0 [next hop address]
	- ip route 0.0.0.0 0.0.0.0 [Exit i/f]
	- ip default-network [연결되어있는 네트워크 주소]

## 라우팅 프로토콜의 클래스
- Distance Vector 라우팅 프로토콜
	- Bellman Ford가 만듦
	- 라우팅 루프
		- 발생이유
			- 한 네트워크가 다운되면 라우터는 이 정보를 다른 라우터들에게 알리게 됨
			- 근데 이 정보를 받지 못한 라우터에서 다운된 네트워크로 가는정보를 옆에 있는 라우터에 알려줌
			- 그 라우터는 그것을 새로운 정보로 받아들이고 라우팅테이블을 수정한다
			- 그렇게 계속 이 정보가 돌고 도는 것이 라우팅 루프임
			- 이렇게 되면 다운된 네트워크로 가는 길의 hop수가 라우터에서 멈추지 않고 계속해서 늘어남
		- 해결방법
			- 최대 Hop count
				- 루프 도는 hop 카운트를 15까지 제한해 버림
				- 그럼 라우터에서 hop수가 16이 되는 것들을 infinity로 간주해버리고 해당 패킷을 버림
				- 하지만 이것은 패킷이 무한히 도는것은 막을수 있지만 루프 자체를 방지하는 방법은 아님
			- Split Horizon
				- 자신에게 정보를 준 라우터로 또 정보를 전달하지 않는 것
				- 만일 한 라우터가 어떤 네트워크가 다운됬다는 것을 다른 라우터들에게 알려줬는데
				- 그정보를 아직 받지 못한 라우터에서 그 다운된 네트워크로 가는 정보를 그 옆 네트워크로 전달하고
				- 그 잘못된 정보를 받은 라우터는 다시 그 옆에 네트워크가 다운 됐다는 것을 알려준 라우터에게 정보를 전달하려고 할떄 이 라우터는 그 정보를 받지 않음.
				- 왜냐면 자신이 먼저 전파한 네트워크에 대한 정보를 다시 받지 않는 것임.
			- Poison Reverse
				- 경로를 완전히 죽이고 이것에 대한 확인메세지를 보내는 것
				- 자신과 연결되어 있는 네트워크가 다운되면 라우팅테이블에 그 네트워크에 대한 hop수를 16으로 지정해놓고 주변 라우터에 이 정보를 전달한다.(route poisoning)
				- 그 정보를 받은 라우터들도 해당 네트워크의 hop수를 16으로 지정해둔다. 그리고 그 정보를 받은 라우터에게 확인했다는 확인메세지를 보낸다.(poison reverse)
			- Holddown Timer
				- 어떤 라우터로부터 한 네트워크가 다운됐다는 것을 알게 되면 이 네트워크를 route poisoning을 하고 hold-down timer를 시작한다
				- 이 타이머가 만료되기전에 네트워크가 다운됐다는 것을 알려준 라우터에서 다시 네트워크가 살아났다는 정보를 받으면 이를 적용하고 타이머를 해제함 (새로운 metric 값이 원래 알고 있던 값과 같을 경우 받아들임) (rip에서 metric은 hop수)
				- 다른 이웃 라우터로부터 원래 가지고 있던 metric 보다 더 좋은 metric 정보를 받으면 이를 라우팅 테이블에 적용하고 타이머를 해제한다.(새로운 metric 값이 원래 가지고 있던 값보다 작을 경우 받아들임)
				- 타이머 만료 전에 다른 이웃 라우터로부터 원래 알고 있던 metric보다 안좋은 metric을 알려주면 무시한다.(새로운 metric값이 원래 알던것보다 높을 경우 무시함)
			- Triggered Update
				- Distance Vector 라우팅 프로토콜은 주기적으로 자신의 라우팅테이블을 이웃 라우터에게 전달하는데 rip경우 이 주기는 30초임
				- 만일 네트워크가 다운됐을때 이 정보를 바로 모든 라우터에게 전달하지 못하고 주기를 기다려야함.
				- 그러면 정보전달이 늦어져 라우팅 루프가 발생할 가능성이 높음
				- 그래서 네트워크 문제가 생겼을때 즉시 업데이트 내용을 이웃 라우터에게 전송하는 방식임
	- 종류
		- RIP(Routing Information Protocol)
		- IGRP
- Link State 라우팅 프로토콜
	- 다익스트라가 만듦
	- 종류
		- OSPF
- 하이브리드 라우팅 프로토콜
	- Distance vetor + Link State
	- 종류
		- EIGRP

## 라우터 프롬프트
- 유저모드(User EXEC Mode)
	- '>'
- 특권모드(Privileged EXEC Mode)
	- '#'
- 콘피그 모드(Global Configuration Mode)
	- (config)#
- 인터페이스 모드(Interface Mode)
	- (config-if)#
- 라인 모드(line Mode)
	- (config-line)#
		- 사용자 패스워드 설정 모드
- 라우터 모드(router Mode)
	- (config-router)#
- 서브인터페이스모드(subinterface Mode)
	- (config-subif)#

## Show 메세지
- Show run
	- 환경설정 보기
- Show ip route
- show version
	- 시스템 관련 중요 정보를 보여줌
	- IOS 버전과 이름, 라우터 사양 등
- show controllers
	- 인터페이스의 하드웨어 정보를 볼수 있음
	- 시리얼 인터페이스가 DCE인지 DTE인지 확인가능
- show ip interface [보고 싶은 인터페이스 no.]
	- 인터페이스 상세 정보를 볼 수 있음
- show ip protocols
	- 타이머 종류와 expire 될 때까지의 시간이 표시됨